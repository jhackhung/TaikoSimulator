Microsoft (R) Macro Assembler Version 14.42.34435.0	    12/21/24 12:19:13
main_game_page.asm					     Page 1 - 1


				.686P
				.XMM

				.model flat, c
				include csfml.inc
			      C ; CSFML.INC - SFML Definitions for x86 Assembly
			      C ; 使用 MASM 語法
			      C 
			      C includelib csfml-audio.lib
			      C includelib csfml-graphics.lib
			      C includelib csfml-system.lib
			      C includelib csfml-window.lib
			      C 
			      C ; sfBool 定義
 = 00000000		      C sfFalse     equ 0
 = 00000001		      C sfTrue      equ 1
			      C 
			      C ; sfEventType 定義
 = 00000000		      C sfEvtClosed               equ 0
 = 00000001		      C sfEvtResized              equ 1
 = 00000002		      C sfEvtLostFocus            equ 2
 = 00000003		      C sfEvtGainedFocus          equ 3
 = 00000004		      C sfEvtTextEntered          equ 4
 = 00000005		      C sfEvtKeyPressed           equ 5
 = 00000006		      C sfEvtKeyReleased          equ 6
 = 00000007		      C sfEvtMouseWheelMoved      equ 7
 = 00000008		      C sfEvtMouseWheelScrolled   equ 8
 = 00000009		      C sfEvtMouseButtonPressed   equ 9
 = 0000000A		      C sfEvtMouseButtonReleased  equ 10
 = 0000000B		      C sfEvtMouseMoved           equ 11
 = 0000000C		      C sfEvtMouseEntered         equ 12
 = 0000000D		      C sfEvtMouseLeft            equ 13
			      C 
			      C ; sfMouseButton 定義
 = 00000000		      C sfMouseLeft   equ 0
 = 00000001		      C sfMouseRight  equ 1
 = 00000002		      C sfMouseMiddle equ 2
			      C 
			      C ; sfKey 定義
 = 0000003A		      C sfKeyEnter    equ 58
 = 00000000		      C sfKeyA        equ 0
 = 00000012		      C sfKeyS        equ 18
 = 00000003		      C sfKeyD        equ 3
 = 00000024		      C sfKeyEscape   equ 36
			      C 
			      C ; 視窗風格定義
 = 00000000		      C sfNone       equ 0
 = 00000001		      C sfTitlebar   equ 1
 = 00000002		      C sfResize     equ 2
 = 00000004		      C sfClose      equ 4
 = 00000008		      C sfFullscreen equ 8
			      C 
			      C ; 結構體定義
 00000008		      C sfVector2f STRUCT
 00000000  00000000	      C     x REAL4 ?
 00000004  00000000	      C     y REAL4 ?
			      C sfVector2f ENDS
			      C 
 00000008		      C sfVector2i STRUCT
 00000000  00000000	      C     x SDWORD ?
 00000004  00000000	      C     y SDWORD ?
			      C sfVector2i ENDS
			      C 
 0000000C		      C sfVideoMode STRUCT
 00000000  00000000	      C     _width  DWORD ?
 00000004  00000000	      C     height DWORD ?
 00000008  00000000	      C     bpp    DWORD ?
			      C sfVideoMode ENDS
			      C 
 00000004		      C sfColor STRUCT
 00000000  00		      C     r BYTE ?
 00000001  00		      C     g BYTE ?
 00000002  00		      C     b BYTE ?
 00000003  00		      C     a BYTE ?
			      C sfColor ENDS
			      C 
 00000010		      C sfFloatRect STRUCT
 00000000  00000000	      C     left   REAL4 ?
 00000004  00000000	      C     top    REAL4 ?
 00000008  00000000	      C     _width  REAL4 ?
 0000000C  00000000	      C     height REAL4 ?
			      C sfFloatRect ENDS
			      C 
 0000000C		      C mouseButton STRUCT
 00000000  00000000	      C     button DWORD ?
 00000004  00000000	      C     x DWORD ?
 00000008  00000000	      C     y DWORD ?
			      C mouseButton ENDS
			      C 
 00000014		      C key STRUCT
 00000000  00000000	      C     code DWORD ?
 00000004  00000000	      C     alt DWORD ?
 00000008  00000000	      C     control DWORD ?
 0000000C  00000000	      C     shift DWORD ?
 00000010  00000000	      C     system DWORD ?
			      C key ENDS
			      C 
 00000030		      C sfEvent STRUCT
 00000000  00000000	      C     _type DWORD ?                
 00000004  00000000	      C     _size DWORD ?                
 00000008  00000000	      C     mouse mouseButton <>       
	   00000000
	   00000000
 00000014  00000000	      C     _key key <>                 
	   00000000
	   00000000
	   00000000
	   00000000
 00000028  00000000	      C     mouseMove sfVector2i <>     
	   00000000
			      C sfEvent ENDS
			      C 
 00000004		      C sfTime STRUCT
 00000000  00000000	      C     microseconds DWORD ?    
			      C sfTime ENDS
			      C 
			      C ; 函數原型 - 視窗相關
			      C EXTERN sfRenderWindow_create:PROC
			      C EXTERN sfRenderWindow_destroy:PROC
			      C EXTERN sfRenderWindow_close:PROC
			      C EXTERN sfRenderWindow_isOpen:PROC
			      C EXTERN sfRenderWindow_clear:PROC
			      C EXTERN sfRenderWindow_display:PROC
			      C EXTERN sfRenderWindow_pollEvent:PROC
			      C EXTERN sfRenderWindow_drawSprite:PROC
			      C EXTERN sfRenderWindow_drawText:PROC
			      C 
			      C ; 函數原型 - 紋理相關
			      C EXTERN sfTexture_createFromFile:PROC
			      C EXTERN sfTexture_destroy:PROC
			      C 
			      C ; 函數原型 - 精靈相關
			      C EXTERN sfSprite_create:PROC
			      C EXTERN sfSprite_destroy:PROC
			      C EXTERN sfSprite_setTexture:PROC
			      C EXTERN sfSprite_setPosition:PROC
			      C EXTERN sfSprite_setOrigin:PROC
			      C EXTERN sfSprite_move:PROC
			      C EXTERN sfSprite_getPosition:PROC
			      C 
			      C ; 函數原型 - 音樂相關
			      C EXTERN sfMusic_createFromFile:PROC
			      C EXTERN sfMusic_destroy:PROC
			      C EXTERN sfMusic_play:PROC
			      C EXTERN sfMusic_setLoop:PROC
			      C EXTERN sfMusic_stop: PROC
			      C EXTERN sfMusic_getStatus: PROC
			      C 
			      C ; 函數原型 - 文字相關
			      C EXTERN sfFont_createFromFile:PROC
			      C EXTERN sfFont_destroy:PROC
			      C EXTERN sfText_create:PROC
			      C EXTERN sfText_destroy:PROC
			      C EXTERN sfText_setFont:PROC
			      C EXTERN sfText_setString:PROC
			      C EXTERN sfText_setCharacterSize:PROC
			      C EXTERN sfText_setFillColor:PROC
			      C EXTERN sfText_setOutlineColor:PROC
			      C EXTERN sfText_setOutlineThickness:PROC
			      C EXTERN sfText_getLocalBounds:PROC
			      C EXTERN sfText_getGlobalBounds:PROC
			      C EXTERN sfText_setPosition:PROC
			      C 
			      C ; 函數原型 - 顏色相關
			      C EXTERN sfColor_fromRGB:PROC
			      C EXTERN sfColor_fromRGBA:PROC
			      C 
			      C ; 函數原型 - 矩形相關
			      C EXTERN sfRectangleShape_create: PROC
			      C EXTERN sfRectangleShape_setPosition: PROC
			      C EXTERN sfRectangleShape_setSize: PROC
			      C EXTERN sfRectangleShape_setFillColor: PROC
			      C EXTERN sfRectangleShape_setOutlineThickness: PROC
			      C EXTERN sfRenderWindow_drawRectangleShape: PROC
			      C EXTERN sfRectangleShape_destroy: PROC
			      C EXTERN sfRectangleShape_setOutlineColor: PROC
			      C 
			      C EXTERN sfSleep: PROC
			      C 
			      C EXTERN sfClock_create:PROC
			      C EXTERN sfClock_getElapsedTime:PROC
			      C EXTERN sfClock_restart:PROC
			      C EXTERN sfClock_destroy:PROC
			      C 

				extern currentPage: DWORD
				extern create_button: PROC
				extern GetStdHandle@4:PROC
				extern CreateFileA@28:PROC
				extern WriteFile@20:PROC
				extern ReadFile@20:PROC
				extern ExitProcess@4:PROC
				extern CloseHandle@4:PROC
				extern WriteConsoleA@20:PROC
				extern GetLastError@0:PROC

				; 定義常量
 = 0x80000000			GENERIC_READ         EQU 0x80000000
 = 0x00000001			FILE_SHARE_READ      EQU 0x00000001
 =-0000000B			STD_OUTPUT_HANDLE equ -11
 = 00000003			OPEN_EXISTING        EQU 3
 = 0x00000080			FILE_ATTRIBUTE_NORMAL EQU 0x00000080

 = 00000000			BUTTON_STATE_NORMAL equ 0
 = 00000001			BUTTON_STATE_PRESSED equ 1

 00000008			Button STRUCT
 00000000  00000000		    shape dd ?
 00000004  00000000		    state dd ?
				Button ENDS

				; Drum 結構
 00000008			Drum STRUCT
 00000000  00000000		    sprite dd 0
 00000004  00000000		    dtype dd 0      ; 1 = 紅色鼓, 2 = 藍色鼓
				Drum ENDS

 00000000			.data
				    ; 檔案路徑
 00000000 61 73 73 65 74	    bg_path db "assets/main/game_background.jpg", 0
	   73 2F 6D 61 69
	   6E 2F 67 61 6D
	   65 5F 62 61 63
	   6B 67 72 6F 75
	   6E 64 2E 6A 70
	   67 00
 00000020 61 73 73 65 74	    red_drum_path db "assets/main/red_note.png", 0
	   73 2F 6D 61 69
	   6E 2F 72 65 64
	   5F 6E 6F 74 65
	   2E 70 6E 67 00
 00000039 61 73 73 65 74	    blue_drum_path db "assets/main/blue_note.png", 0
	   73 2F 6D 61 69
	   6E 2F 62 6C 75
	   65 5F 6E 6F 74
	   65 2E 70 6E 67
	   00
 00000053 61 73 73 65 74	    selected_music_path db "assets/main/song1.ogg", 0
	   73 2F 6D 61 69
	   6E 2F 73 6F 6E
	   67 31 2E 6F 67
	   67 00
 00000069 61 73 73 65 74	    selected_beatmap_path db "assets/music/song1_beatmap.tja", 0
	   73 2F 6D 75 73
	   69 63 2F 73 6F
	   6E 67 31 5F 62
	   65 61 74 6D 61
	   70 2E 74 6A 61
	   00
 00000088 61 73 73 65 74	    selectedMusicPath db "assets/main/song2.ogg", 0
	   73 2F 6D 61 69
	   6E 2F 73 6F 6E
	   67 32 2E 6F 67
	   67 00
 0000009E 61 73 73 65 74	    selectedBeatmapPath db "assets/main/song1.tja", 0
	   73 2F 6D 61 69
	   6E 2F 73 6F 6E
	   67 31 2E 74 6A
	   61 00
 000000B4 61 73 73 65 74	    red_note_sound_path db "assets/main/RedNote.wav", 0
	   73 2F 6D 61 69
	   6E 2F 52 65 64
	   4E 6F 74 65 2E
	   77 61 76 00
 000000CC 61 73 73 65 74	    blue_note_sound_path db "assets/main/BlueNote.wav", 0
	   73 2F 6D 61 69
	   6E 2F 42 6C 75
	   65 4E 6F 74 65
	   2E 77 61 76 00

				    ;常數
 = 00000064			    MAX_DRUMS equ 100 
 = 00000008			    Drum_struct_size equ 8     ; Drum 結構大小
 = 00002710			    MAX_NOTES equ 10000
 = 000003E8			    MAX_LINE_LENGTH equ 1000
 = 1280.0			    SCREEN_WIDTH equ 1280.0
 = 000002D0			    SCREEN_HEIGHT equ 720
 000000E5 3F000000		    DRUM_SPEED dd 0.5
 000000E9 42C80000		    track_height REAL4 100.0
 000000ED 44A00000		    track_width REAL4 1280.0
 000000F1 44200000		    track_x REAL4 640.0
 000000F5 43480000		    track_y REAL4 200.0
 000000F9 00000000		    spritePosX    dd 0.0
 000000FD 00000000		    spritePosY    dd 0.0
 00000101 40400000		    outline_thickness REAL4 3.0




				    ; CSFML 物件
 00000105 00000000		    bgTexture dd 0
 00000109 00000000		    bgSprite dd 0
 0000010D 00000000		    redDrumTexture dd 0
 00000111 00000000		    blueDrumTexture dd 0
 00000115  00000320 [		    drumQueue dd MAX_DRUMS * Drum_struct_size DUP(0)
	    00000000
	   ]
 00000D95 00000000		    bgmusic dd 0
 00000D99 00000000		    trackBounds sfFloatRect <>
	   00000000
	   00000000
	   00000000
 00000DA9 00000000		    track_shape Button <>
	   00000000
 00000DB1 00000000		    current_drum Drum <>
	   00000000

				    ;Queue 相關
 00000DB9 00000000		    front dd 0
 00000DBD 00000000		    rear dd 0
 00000DC1 00000000		    qsize dd 0

				    ; 時間相關
 00000DC5 00000000		    clock dd 0
 00000DC9 00000000		    note_timer REAL4 0.0       ; 音符生成計時器
				    ;note_interval REAL4 1.0    ; 每 1 秒生成一個音符

				    ;譜面相關
 00000DCD 42E34CCD		    bpm dd 113.65 ; 預設 BPM
 00000DD1 00000000		    noteSpawnInterval REAL4 0.0  ; 音符生成間隔 (毫秒)

 00000DD5 00000000		    totalNotes dd 0

				    ; 視窗設定
 00000DD9 00000500		    window_videoMode sfVideoMode <1280, 720, 32>
	   000002D0
	   00000020
 00000DE5 54 61 69 6B 6F	    windowTitle db "Taiko Simulator", 0
	   20 53 69 6D 75
	   6C 61 74 6F 72
	   00
				    ;scrollSpeed REAL4 -0.5      ; 音符滾動速度 (向左移動)

				    ; 事件結構
 00000DF5 00000000		    event sfEvent <>
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000
	   00000000

				    ; 確認鍵盤按鍵, 追蹤按鍵是否按下
 00000E25 00000000		    KeyA_state dd 0
 00000E29 00000000		    KeyD_state dd 0
 00000E2D 00000000		    KeyS_state dd 0 ;   for testing

				    ; 顏色常數
 00000E31 FF FF FF FF		    whiteColor sfColor <255, 255, 255, 255> ; 白色
 00000E35 00 00 00 FF		    blackColor sfColor <0, 0, 0, 255>       ; 黑色
 00000E39 A9 A9 A9 FF		    gray_color sfColor <169, 169, 169, 255>
 00000E3D 69 69 69 FF		    dark_gray_color sfColor <105, 105, 105, 255>
 00000E41 D2 D2 D2 FF		    light_gray_color sfColor <210, 210, 210, 255>
 00000E45 FF EF C6 FF		    beige_color sfColor <255, 239, 198, 255>
 00000E49 00 00 00 FF		    black_color sfColor <0, 0, 0, 255>

 00000E4D 44A00000		    initialPosition sfVector2f <SCREEN_WIDTH, 200.0>  ; 音符的 X 和 Y 座標
	   43480000
				    ;movePosition sfVector2f <-0.1, 0.0>


				    ; 音符相關
 00000E55  00000100 [		    notes db 256 DUP(0)
	    00
	   ]
 00000F55  00000100 [		    noteTimings REAL4 256 DUP(0.0)
	    00000000
	   ]

				    ;讀檔相關
 00001355 00000000		    stdout_handle dd 0

 00001359 72 69 63 6B 72	    filename db "rickroll.txt", 0
	   6F 6C 6C 2E 74
	   78 74 00
 00001366 00000000		    hFile dd 0
 0000136A 00000000		    bytesRead dd 0
 0000136E  00000400 [		    readBuffer db 1024 dup(0)
	    00
	   ]

 0000176E 00000000		    musicInfo_bpm REAL4 0.0
 00001772 00000000		    musicInfo_offset REAL4 0.0

 00001776  000003E8 [		    lineBuffer db MAX_LINE_LENGTH DUP(0)
	    00
	   ]
 00001B5E 00			    noteSection db 0
 00001B5F 00000000		    currentTime REAL4 0.0

 00001B63 42 50 4D 3A 00	    bpmTag db "BPM:", 0
 00001B68 4F 46 46 53 45	    offsetTag db "OFFSET:", 0
	   54 3A 00
 00001B70 23 53 54 41 52	    startTag db "#START", 0
	   54 00
 00001B77 23 45 4E 44 00	    endTag db "#END", 0
 00001B7C 2C 00			    comma db ",", 0

 00001B7E 00000000		    drumSpeed REAL4 0.0
 00001B82 00000000		    drumStep REAL4 0.0

 00001B86 52 65 61 64 20	    msgReadFail db "Read file failed.", 13, 10, 0
	   66 69 6C 65 20
	   66 61 69 6C 65
	   64 2E 0D 0A 00
 00001B9A 46 69 6C 65 20	    msgReadSuccess db "File content:", 13, 10, 0
	   63 6F 6E 74 65
	   6E 74 3A 0D 0A
	   00


 00001BAA 44960000		    notePosition sfVector2f <1200.0, 200.0>  ; 音符的 X 和 Y 座標
	   43480000
 00001BB2 BDCCCCCD		    movePosition sfVector2f <-0.1, 0.0>
	   00000000
				    
				     ; 判定窗口 (以毫秒計)
 00001BBA 00000023		    hitWindowGreat DWORD 35   ; "Great" 判定範圍
 00001BBE 00000050		    hitWindowGood  DWORD 80   ; "Good" 判定範圍
 00001BC2 00000078		    hitWindowMiss  DWORD 120  ; "Miss" 判定範圍

				    ; 用來存great good miss 的次數和最後總分
 00001BC6 00000000		    great_count DWORD 0
 00001BCA 00000000		    good_count DWORD 0
 00001BCE 00000000		    miss_count DWORD 0
 00001BD2 00000000		    score DWORD 0

				   

 00000000			.code

				;播放音樂
 00000000			game_play_music PROC
 00000000  68 00000053 R	    push offset selected_music_path
 00000005  E8 00000000 E	    call sfMusic_createFromFile
 0000000A  83 C4 04		    add esp, 4 
 0000000D  A3 00000D95 R	    mov bgMusic, eax

 00000012  50			    push eax
 00000013  E8 00000000 E	    call sfMusic_play
 00000018  83 C4 04		    add esp, 4
 0000001B  C3			    ret
 0000001C			game_play_music ENDP



				; 載入背景
 0000001C			@load_bg PROC
				    ; 創建背景紋理
 0000001C  6A 00		    push 0
 0000001E  68 00000000 R	    push offset bg_path
 00000023  E8 00000000 E	    call sfTexture_createFromFile
 00000028  83 C4 08		    add esp, 8
 0000002B  85 C0		    test eax, eax
 0000002D  74 2B		    jz @fail_load
 0000002F  A3 00000105 R	    mov bgTexture, eax

				    ; 創建背景精靈
 00000034  E8 00000000 E	    call sfSprite_create
 00000039  85 C0		    test eax, eax
 0000003B  74 1D		    jz @fail_load
 0000003D  A3 00000109 R	    mov DWORD PTR [bgSprite], eax

				    ; 設定紋理
 00000042  6A 01		    push 1
 00000044  A1 00000105 R	    mov eax, DWORD PTR [bgTexture]
 00000049  50			    push eax
 0000004A  8B 0D 00000109 R	    mov ecx, DWORD PTR [bgSprite]
 00000050  51			    push ecx
 00000051  E8 00000000 E	    call sfSprite_setTexture
 00000056  83 C4 0C		    add esp, 12
 00000059  C3			    ret

 0000005A			@fail_load:
 0000005A  B8 00000000		    mov eax, 0
 0000005F  C3			    ret
 00000060			@load_bg ENDP

 00000060			create_track PROC
				     ; 初始化軌道
 00000060  51			    push ecx
 00000061  F3/ 0F 10 05		    movss xmm0, dword ptr [track_height]
	   000000E9 R
 00000069  F3/ 0F 11 04 24	    movss dword ptr [esp], xmm0

 0000006E  51			    push ecx
 0000006F  F3/ 0F 10 05		    movss xmm0, dword ptr [track_width]
	   000000ED R
 00000077  F3/ 0F 11 04 24	    movss dword ptr [esp], xmm0

 0000007C  51			    push ecx
 0000007D  F3/ 0F 10 05		    movss xmm0, dword ptr [track_y]
	   000000F5 R
 00000085  F3/ 0F 11 04 24	    movss dword ptr [esp], xmm0

 0000008A  51			    push ecx
 0000008B  F3/ 0F 10 05		    movss xmm0, dword ptr [track_x]
	   000000F1 R
 00000093  F3/ 0F 11 04 24	    movss dword ptr [esp], xmm0

 00000098  E8 00000000 E	    call create_button
 0000009D  83 C4 10		    add esp, 16
 000000A0  A3 00000DA9 R	    mov dword ptr [track_shape], eax
 000000A5  C7 05 00000DAD R	    mov dword ptr [track_shape.state], BUTTON_STATE_NORMAL
	   00000000

				    ; 修改底部長方形顏色和邊框
 000000AF  FF 35 00000E35 R	    push blackColor  ; 黑色
 000000B5  FF 35 00000DA9 R	    push dword ptr [track_shape]
 000000BB  E8 00000000 E	    call sfRectangleShape_setFillColor
 000000C0  83 C4 08		    add esp, 8

 000000C3  FF 35 00000E31 R	    push whiteColor  ; 白色邊框
 000000C9  FF 35 00000DA9 R	    push dword ptr [track_shape]
 000000CF  E8 00000000 E	    call sfRectangleShape_setOutlineColor
 000000D4  83 C4 08		    add esp, 8
 000000D7  C3			    ret   
 000000D8			create_track ENDP

				; 載入紅鼓紋理
 000000D8			@load_red_texture PROC

 000000D8  6A 00		    push 0
 000000DA  68 00000020 R	    push offset red_drum_path
 000000DF  E8 00000000 E	    call sfTexture_createFromFile
 000000E4  83 C4 08		    add esp, 8
 000000E7  85 C0		    test eax, eax
 000000E9  74 06		    jz @fail_load
 000000EB  A3 0000010D R	    mov redDrumTexture, eax

 000000F0  C3			    ret
 000000F1			@fail_load:
 000000F1  B8 00000000		    mov eax, 0
 000000F6  C3			    ret
 000000F7			@load_red_texture ENDP

				; 載入藍鼓紋理
 000000F7			@load_blue_texture PROC
 000000F7  6A 00		    push 0
 000000F9  68 00000039 R	    push offset blue_drum_path
 000000FE  E8 00000000 E	    call sfTexture_createFromFile
 00000103  83 C4 08		    add esp, 8
 00000106  85 C0		    test eax, eax
 00000108  74 06		    jz @fail_load
 0000010A  A3 00000111 R	    mov blueDrumTexture, eax

 0000010F  C3			    ret
 00000110			@fail_load:
 00000110  B8 00000000		    mov eax, 0
 00000115  C3			    ret
 00000116			@load_blue_texture ENDP

 00000116			isQueueFull PROC
 00000116  A1 00000DC1 R	    mov eax, qsize
 0000011B  83 F8 64		    cmp eax, MAX_DRUMS
 0000011E  74 05		    je queue_full
 00000120  B8 00000000		    mov eax, 0

 00000125			queue_full:
 00000125  B8 00000001		    mov eax, 1

 0000012A  C3			    ret
 0000012B			isQueueFull ENDP

 0000012B			isQueueEmpty PROC
 0000012B  A1 00000DC1 R	    mov eax, qsize
 00000130  83 F8 00		    cmp eax, 0
 00000133  74 05		    je queue_empty
 00000135  B8 00000000		    mov eax, 0

 0000013A			queue_empty:
 0000013A  B8 00000001		    mov eax, 1

 0000013F  C3			    ret
 00000140			isQueueEmpty ENDP

 00000140			enqueue PROC
 00000140  E8 FFFFFFD1		    call isQueueFull
 00000145  83 F8 01		    cmp eax, 1
 00000148  74 44		    je end_enqueue
				    
 0000014A  A1 00000DB1 R	    mov eax, [current_drum.sprite]      ; sprite
 0000014F  8B 1D 00000DB5 R	    mov ebx, [current_drum.dtype]       ; dtype
 00000155  8D 3D 00000115 R	    lea edi, drumQueue

				    ; 計算擺放位置
 0000015B  A1 00000DBD R	    mov eax, [rear]        
 00000160  BA 00000008		    mov edx, Drum_struct_size
 00000165  F7 E2		    mul edx                  
 00000167  03 F8		    add edi, eax 

				    ; 儲存drum資料
 00000169  89 07		    mov [edi], eax           ; sprite
 0000016B  89 5F 04		    mov [edi + 4], ebx       ; dtype

				    ; 更新rear、size
 0000016E  FF 05 00000DBD R	    inc dword ptr [rear]
 00000174  A1 00000DBD R	    mov eax, [rear]
 00000179  33 D2		    xor edx, edx
 0000017B  B9 00000064		    mov ecx, MAX_DRUMS
 00000180  F7 F1		    div ecx
 00000182  89 15 00000DBD R	    mov dword ptr [rear], edx
 00000188  FF 05 00000DC1 R	    inc dword ptr [qsize]

 0000018E			end_enqueue:
 0000018E  C3			    ret
 0000018F			enqueue ENDP

 0000018F			dequeue PROC
 0000018F  E8 FFFFFF97		    call isQueueEmpty
 00000194  83 F8 01		    cmp eax, 1
 00000197  74 42		    je end_dequeue

				    ; 計算移除位置
 00000199  8D 3D 00000115 R	    lea edi, drumQueue
 0000019F  A1 00000DB9 R	    mov eax, [front]
 000001A4  BA 00000008		    mov edx, Drum_struct_size
 000001A9  F7 E2		    mul edx
 000001AB  03 F8		    add edi, eax

				    ; 讀取 drum
 000001AD  8B 07		    mov eax, [edi]           ;sprite
 000001AF  8B 5F 04		    mov ebx, [edi + 4]       ;dtype

				    ;釋放資源
 000001B2  50			    push eax
 000001B3  E8 00000000 E	    call sfSprite_destroy
 000001B8  83 C4 04		    add esp, 4

				    ; 更新front、size
 000001BB  FF 05 00000DB9 R	    inc dword ptr [front]
 000001C1  A1 00000DB9 R	    mov eax, [front]
 000001C6  33 D2		    xor edx, edx
 000001C8  B9 00000064		    mov ecx, MAX_DRUMS
 000001CD  F7 F1		    div ecx
 000001CF  89 15 00000DB9 R	    mov dword ptr [front], edx
 000001D5  FF 0D 00000DC1 R	    dec dword ptr [qsize]

 000001DB			end_dequeue:
 000001DB  C3			    ret
 000001DC			dequeue ENDP

 000001DC			spawnDrum PROC             ;call前type要先push到eax
 000001DC  E8 FFFFFF35		    call isQueueFull
 000001E1  83 F8 01		    cmp eax, 1
 000001E4  74 3C		    je end_spawn

 000001E6  A3 00000DB5 R	    mov dword ptr [current_drum.dtype], eax
 000001EB  E8 00000000 E	    call sfSprite_create
 000001F0  A3 00000DB1 R	    mov DWORD PTR [current_drum.sprite], eax

 000001F5  83 3D 00000DB5 R	    cmp dword ptr [current_drum.dtype], 1
	   01
 000001FC  74 05		    je spawnRed
 000001FE  E8 FFFFFEF4		    call @load_blue_texture

 00000203			spawnRed:
 00000203  E8 FFFFFED0		    call @load_red_texture

				    ;設定位置
 00000208  FF 35 00000E51 R	    push dword ptr [initialPosition+4] ; Y 座標
 0000020E  FF 35 00000E4D R	    push dword ptr [initialPosition]   ; X 座標
 00000214  50			    push eax
 00000215  E8 00000000 E	    call sfSprite_setPosition
 0000021A  83 C4 0C		    add esp, 12

 0000021D  E8 FFFFFF1E		    call enqueue

 00000222			end_spawn:
 00000222  C3			    ret
 00000223			spawnDrum ENDP

 00000223			updateDrums PROC
 00000223  83 3D 00000DC1 R	    cmp qsize, 0
	   00
 0000022A  0F 86 000000A7	    jbe end_update
				    
 00000230  8D 3D 00000115 R	    lea edi, drumQueue
 00000236  A1 00000DB9 R	    mov eax, [front]
 0000023B  BA 00000008		    mov edx, Drum_struct_size
 00000240  F7 E2		    mul edx
 00000242  03 F8		    add edi, eax

				    ; 讀取 drum
 00000244  8B 07		    mov eax, [edi]           ;sprite
 00000246  8B 5F 04		    mov ebx, [edi + 4]       ;dtype

 00000249  50			    push eax
 0000024A  E8 00000000 E	    call sfSprite_getPosition
 0000024F  83 C4 08		    add esp, 8

 00000252  F3/ 0F 11 05		    movss [spritePosX], xmm0
	   000000F9 R
 0000025A  83 05 000000F9 R	    add [spritePosX], 50
	   32
 00000261  83 3D 000000F9 R	    cmp [spritePosX], 50
	   32
 00000268  73 6D		    jae end_update

 0000026A  E8 FFFFFF20		    call dequeue

 0000026F  8B 0D 00000DC1 R	    mov ecx, qsize
 00000275  8B 1D 00000DB9 R	    mov ebx, front
 0000027B			update_queue:
				    ; 讀取 drum
 0000027B  8B 07		    mov eax, [edi]           ;sprite

 0000027D  50			    push eax
 0000027E  E8 00000000 E	    call sfSprite_getPosition
 00000283  83 C4 08		    add esp, 8
				    
 00000286  F3/ 0F 11 05		    movss [spritePosX], xmm0
	   000000F9 R
 0000028E  F3/ 0F 11 0D		    movss [spritePosY], xmm1
	   000000FD R
 00000296  F3/ 0F 10 05		    movss xmm0, [spritePosX]
	   000000F9 R
 0000029E  F3/ 0F 10 0D		    movss xmm1, [DRUM_SPEED]
	   000000E5 R
 000002A6  F3/ 0F 5C C1		    subss xmm0, xmm1
 000002AA  F3/ 0F 11 05		    movss [spritePosX], xmm0
	   000000F9 R

 000002B2  FF 35 000000FD R	    push dword ptr [spritePosY] ; Y 座標
 000002B8  FF 35 000000F9 R	    push dword ptr [spritePosX]   ; X 座標
 000002BE  50			    push eax
 000002BF  E8 00000000 E	    call sfSprite_setPosition
 000002C4  83 C4 0C		    add esp, 12

 000002C7  43			    inc ebx
 000002C8  8B C3		    mov eax, ebx
 000002CA  33 D2		    xor edx, edx
 000002CC  B9 00000064		    mov ecx, MAX_DRUMS
 000002D1  F7 F1		    div ecx
 000002D3  8B DA		    mov ebx, edx

 000002D5  E2 A4		loop update_queue

 000002D7			end_update:
 000002D7  C3			    ret
 000002D8			updateDrums ENDP

				;播放音效
 000002D8			rednote_sound PROC
 000002D8  68 000000B4 R	    push offset red_note_sound_path
 000002DD  E8 00000000 E	    call sfMusic_createFromFile
 000002E2  83 C4 04		    add esp, 4 
 000002E5  A3 00000D95 R	    mov bgMusic, eax

 000002EA  50			    push eax
 000002EB  E8 00000000 E	    call sfMusic_play
 000002F0  83 C4 04		    add esp, 4
 000002F3  C3			    ret
 000002F4			rednote_sound ENDP

 000002F4			bluenote_sound PROC
 000002F4  68 000000CC R	    push offset blue_note_sound_path
 000002F9  E8 00000000 E	    call sfMusic_createFromFile
 000002FE  83 C4 04		    add esp, 4 
 00000301  A3 00000D95 R	    mov bgMusic, eax

 00000306  50			    push eax
 00000307  E8 00000000 E	    call sfMusic_play
 0000030C  83 C4 04		    add esp, 4
 0000030F  C3			    ret
 00000310			bluenote_sound ENDP

 00000310			readFile PROC
				    ; 讀取文件內容
 00000310  8B F4		    mov esi, esp

 00000312  6A 00		    push 0
 00000314  68 0000136A R	    push offset bytesRead
 00000319  68 00000400		    push 1024
 0000031E  68 0000136E R	    push offset readBuffer
 00000323  FF 35 00001366 R	    push [hFile]
 00000329  E8 00000000 E	    call ReadFile@20
 0000032E  83 C4 14		    add esp, 20

 00000331  8B E6		    mov esp, esi
 00000333  C3			    ret
 00000334			readFile ENDP

 00000334			main_game_page PROC window:DWORD

				    ; 載入背景
 00000337  E8 FFFFFCE0		    call @load_bg
 0000033C  85 C0		    test eax, eax
 0000033E  0F 84 0000018C	    jz @exit_program

				    ; 載入紅鼓紋理
 00000344  E8 FFFFFD8F		    call @load_red_texture
 00000349  85 C0		    test eax, eax
 0000034B  0F 84 0000017F	    jz @exit_program

				    ; 載入藍鼓紋理
 00000351  E8 FFFFFDA1		    call @load_blue_texture
 00000356  85 C0		    test eax, eax
 00000358  0F 84 00000172	    jz @exit_program

				    ;載入音樂
 0000035E  E8 FFFFFC9D		    call game_play_music
 00000363  85 C0		    test eax, eax
 00000365  0F 84 00000165	    jz @exit_program

				    ; 載入tja檔
				    ;push offset selected_beatmap_path
				    ;call parseNoteChart
				    ;test eax, eax
				    ;jz @exit_program

				    ; 初始化計時器
				    ;call sfClock_create
				    ;test eax, eax
				    ;jz @exit_program
				    ;mov clock, eax

				   

 0000036B			@main_loop:

				    ; 檢查音樂是否停止
 0000036B  FF 35 00000D95 R	    push bgMusic
 00000371  E8 00000000 E	    call sfMusic_getStatus
 00000376  83 C4 04		    add esp, 4
 00000379  83 F8 00		    cmp eax, 0
 0000037C  0F 84 00000124	    je @to_end_page

				    ; 檢查視窗是否開啟
 00000382  8B 45 08		    mov eax, window
 00000385  50			    push eax
 00000386  E8 00000000 E	    call sfRenderWindow_isOpen
 0000038B  83 C4 04		    add esp, 4
 0000038E  85 C0		    test eax, eax
 00000390  0F 84 0000013A	    je @exit_program


				    ; 更新計時器
				    ;mov eax, clock
				    ;push eax
				    ;call sfClock_getElapsedTime
				    ;add esp, 4
				    ;test eax, eax
				    ;jz @exit_program               ; 如果時間返回無效，退出程式

				    ; 檢查音樂是否停止
 00000396  FF 35 00000D95 R	    push bgMusic
 0000039C  E8 00000000 E	    call sfMusic_getStatus
 000003A1  83 C4 04		    add esp, 4
 000003A4  83 F8 00		    cmp eax, 0
 000003A7  0F 84 000000F9	    je @to_end_page

				    ; 提取微秒並轉換為秒數
				    ;mov ebx, 1000000  ; 1,000,000 用於將微秒轉換為秒
				    ;xor edx, edx      ; 清除 edx，準備進行除法操作
				    ;div ebx           ; eax = microseconds / 1,000,000 (秒數)
				    ;cvtsi2ss xmm0, eax

				    ; 判斷是否生成新的音符
				    ;movss xmm1, note_interval
				    ;comiss xmm0, xmm1
				    ;jb @skip_generate_note  ; 若音符生成間隔未達一秒，跳過

				    ; 生成音符並重置計時器
				    ;call @generate_note
				    ;call sfClock_restart           ; 重置時鐘

 000003AD			    @event_loop:
				        ; 事件處理
 000003AD  8D 35 00000DF5 R	        lea esi, event
 000003B3  56			        push esi
 000003B4  8B 45 08		        mov eax, window
 000003B7  50			        push eax
 000003B8  E8 00000000 E	        call sfRenderWindow_pollEvent
 000003BD  83 C4 08		        add esp, 8
 000003C0  85 C0		        test eax, eax
 000003C2  0F 84 000000A6	        je @skip_generate_note
				    
				        ; 檢查關閉事件
 000003C8  83 3E 00		        cmp dword ptr [esi].sfEvent._type, sfEvtClosed
 000003CB  0F 84 0000009D	        je @skip_generate_note

				        ; 檢查滑鼠點擊
 000003D1  83 3E 09		        cmp dword ptr [esi].sfEvent._type, sfEvtMouseButtonPressed
 000003D4  0F 84 000000CC	        je @to_end_page
				    
				        ; 檢查鍵盤事件
 000003DA  83 3E 05		        cmp dword ptr [esi].sfEvent._type, sfEvtKeyPressed
 000003DD  74 02		        je @check_key_press

 000003DF  EB CC		        jmp @event_loop

 000003E1			        @check_key_press:
 000003E1  83 7E 04 00		            cmp dword ptr [esi+4], sfKeyA
 000003E5  74 0E		            je @key_A_pressed

 000003E7  83 7E 04 12		            cmp dword ptr [esi+4], sfKeyS
 000003EB  74 31		            je @key_S_pressed 

 000003ED  83 7E 04 03		            cmp dword ptr [esi+4], sfKeyD
 000003F1  74 4F		            je @key_D_pressed 
				            
 000003F3  EB B8		            jmp @event_loop

 000003F5			@key_A_pressed:
 000003F5  C7 05 00000E25 R	    mov dword ptr [KeyA_state], 1 ; 設定狀態已按下 
	   00000001
 000003FF  C7 05 00000E2D R	    mov dword ptr [KeyS_state], 0
	   00000000
 00000409  C7 05 00000E29 R	    mov dword ptr [KeyD_state], 0
	   00000000
 00000413  E8 FFFFFEC0		    call rednote_sound
 00000418  50			    push eax
 00000419  83 C4 04		    add esp, 4
				    ; delete the the latest note
 0000041C  EB 8F		    jmp @event_loop

 0000041E			@key_S_pressed:
 0000041E  C7 05 00000E2D R	    mov dword ptr [KeyS_state], 1 ; 設定狀態已按下
	   00000001
 00000428  C7 05 00000E25 R	    mov dword ptr [KeyA_state], 0
	   00000000
 00000432  C7 05 00000E29 R	    mov dword ptr [KeyD_state], 0
	   00000000
 0000043C  50			    push eax
 0000043D  83 C4 04		    add esp, 4
 00000440  EB 64		    jmp @to_end_page


 00000442			@key_D_pressed:
 00000442  C7 05 00000E29 R	    mov dword ptr [KeyD_state], 1 ; 設定狀態已按下
	   00000001
 0000044C  C7 05 00000E25 R	    mov dword ptr [KeyA_state], 0
	   00000000
 00000456  C7 05 00000E2D R	    mov dword ptr [KeyS_state], 0
	   00000000
 00000460  E8 FFFFFE8F		    call bluenote_sound
 00000465  50			    push eax
 00000466  83 C4 04		    add esp, 4
				    ; delete the the latest note
 00000469  E9 FFFFFF3F		    jmp @event_loop
				       

 0000046E			@skip_generate_note:
				    ; 更新音符
				    ;call @update_notes

				    ; 清除視窗
 0000046E  FF 35 00000E35 R	    push blackColor
 00000474  FF 75 08		    push window
 00000477  E8 00000000 E	    call sfRenderWindow_clear
 0000047C  83 C4 08		    add esp, 8

				    ; 繪製背景
 0000047F  6A 00		    push 0
 00000481  A1 00000109 R	    mov eax, bgSprite
 00000486  50			    push eax
 00000487  8B 4D 08		    mov ecx, window
 0000048A  51			    push ecx
 0000048B  E8 00000000 E	    call sfRenderWindow_drawSprite
 00000490  83 C4 0C		    add esp, 12

				    ;繪製軌道
				    ;push 0
				    ;mov eax, DWORD PTR [track_shape]
				    ;push eax
				    ;mov ecx, DWORD PTR [window]
				    ;push ecx
				    ;call sfRenderWindow_drawRectangleShape
				    ;add esp, 12

				    ; 繪製音符
 00000493  33 F6		    xor esi, esi
				;@draw_notes_loop:
				    ;cmp esi, noteCount
				    ;jge @end_draw_notes

				    ;mov eax, DWORD PTR [noteSprites + esi*4]
				    ;test eax, eax
				    ;jz @next_draw

				    ;push 0
				    ;push eax
				    ;mov ecx, window
				    ;push ecx
				    ;call sfRenderWindow_drawSprite
				    ;add esp, 12

				;@next_draw:
				    ;inc esi
				    ;jmp @draw_notes_loop
 00000495			@end_draw_notes:

				    ; 顯示視窗
 00000495  8B 45 08		    mov eax, window
 00000498  50			    push eax
 00000499  E8 00000000 E	    call sfRenderWindow_display
 0000049E  83 C4 04		    add esp, 4

 000004A1  E9 FFFFFEC5		    jmp @main_loop

				; 準備結算
 000004A6			@to_end_page:

 000004A6  FF 35 00001BD2 R	    push score    
 000004AC  FF 35 00001BCE R	    push miss_count    
 000004B2  FF 35 00001BCA R	    push good_count   
 000004B8  FF 35 00001BC6 R	    push great_count    
 000004BE  FF 75 08		    push window       
 000004C1  C7 05 00000000 E	    mov DWORD PTR [currentPage], 2      ;遊戲結束要切換到結尾畫面
	   00000002
 000004CB  83 C4 14		    add esp, 20
 000004CE  EB 00		    jmp @exit_program



 000004D0			@exit_program:

				    ;call @cleanup_notes

 000004D0  FF 35 00000109 R	    push bgSprite
 000004D6  E8 00000000 E	    call sfSprite_destroy
 000004DB  83 C4 04		    add esp, 4

 000004DE  FF 35 00000105 R	    push bgTexture
 000004E4  E8 00000000 E	    call sfTexture_destroy
 000004E9  83 C4 04		    add esp, 4

 000004EC  FF 35 0000010D R	    push redDrumTexture
 000004F2  E8 00000000 E	    call sfTexture_destroy
 000004F7  83 C4 04		    add esp, 4

 000004FA  FF 35 00000111 R	    push blueDrumTexture
 00000500  E8 00000000 E	    call sfTexture_destroy
 00000505  83 C4 04		    add esp, 4

 00000508  FF 35 00000DC5 R	    push clock
 0000050E  E8 00000000 E	    call sfClock_destroy
 00000513  83 C4 04		    add esp, 4

				    ;push dword ptr [track_shape]
				    ;call sfRectangleShape_destroy
				    ;add esp, 4

 00000516  FF 35 00000D95 R	    push bgMusic
 0000051C  E8 00000000 E	    call sfMusic_destroy
 00000521  83 C4 04		    add esp, 4

 00000524			    @end:
 00000524  33 C0		    xor eax, eax
				    ret
 00000528			main_game_page ENDP

				END main_game_page
Microsoft (R) Macro Assembler Version 14.42.34435.0	    12/21/24 12:19:13
main_game_page.asm					     Symbols 2 - 1




Structures and Unions:

                N a m e                  Size
                                         Offset      Type

Button . . . . . . . . . . . . .	 00000008
  shape  . . . . . . . . . . . .	 00000000	 DWord
  state  . . . . . . . . . . . .	 00000004	 DWord
Drum . . . . . . . . . . . . . .	 00000008
  sprite . . . . . . . . . . . .	 00000000	 DWord
  dtype  . . . . . . . . . . . .	 00000004	 DWord
key  . . . . . . . . . . . . . .	 00000014
  code . . . . . . . . . . . . .	 00000000	 DWord
  alt  . . . . . . . . . . . . .	 00000004	 DWord
  control  . . . . . . . . . . .	 00000008	 DWord
  shift  . . . . . . . . . . . .	 0000000C	 DWord
  system . . . . . . . . . . . .	 00000010	 DWord
mouseButton  . . . . . . . . . .	 0000000C
  button . . . . . . . . . . . .	 00000000	 DWord
  x  . . . . . . . . . . . . . .	 00000004	 DWord
  y  . . . . . . . . . . . . . .	 00000008	 DWord
sfColor  . . . . . . . . . . . .	 00000004
  r  . . . . . . . . . . . . . .	 00000000	 Byte
  g  . . . . . . . . . . . . . .	 00000001	 Byte
  b  . . . . . . . . . . . . . .	 00000002	 Byte
  a  . . . . . . . . . . . . . .	 00000003	 Byte
sfEvent  . . . . . . . . . . . .	 00000030
  _type  . . . . . . . . . . . .	 00000000	 DWord
  _size  . . . . . . . . . . . .	 00000004	 DWord
  mouse  . . . . . . . . . . . .	 00000008	 
  _key . . . . . . . . . . . . .	 00000014	 
  mouseMove  . . . . . . . . . .	 00000028	 QWord
sfFloatRect  . . . . . . . . . .	 00000010
  left . . . . . . . . . . . . .	 00000000	 DWord
  top  . . . . . . . . . . . . .	 00000004	 DWord
  _width . . . . . . . . . . . .	 00000008	 DWord
  height . . . . . . . . . . . .	 0000000C	 DWord
sfTime . . . . . . . . . . . . .	 00000004
  microseconds . . . . . . . . .	 00000000	 DWord
sfVector2f . . . . . . . . . . .	 00000008
  x  . . . . . . . . . . . . . .	 00000000	 DWord
  y  . . . . . . . . . . . . . .	 00000004	 DWord
sfVector2i . . . . . . . . . . .	 00000008
  x  . . . . . . . . . . . . . .	 00000000	 DWord
  y  . . . . . . . . . . . . . .	 00000004	 DWord
sfVideoMode  . . . . . . . . . .	 0000000C
  _width . . . . . . . . . . . .	 00000000	 DWord
  height . . . . . . . . . . . .	 00000004	 DWord
  bpp  . . . . . . . . . . . . .	 00000008	 DWord


Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

FLAT . . . . . . . . . . . . . .	GROUP
_DATA  . . . . . . . . . . . . .	32 Bit	 00001BD6 Para	  Public  'DATA'	
_TEXT  . . . . . . . . . . . . .	32 Bit	 00000528 Para	  Public  'CODE'	


Procedures, parameters, and locals:

                N a m e                 Type     Value    Attr

@load_bg . . . . . . . . . . . .	P Near	 0000001C _TEXT	Length= 00000044 Public C
  @fail_load . . . . . . . . . .	L Near	 0000005A _TEXT	
@load_blue_texture . . . . . . .	P Near	 000000F7 _TEXT	Length= 0000001F Public C
  @fail_load . . . . . . . . . .	L Near	 00000110 _TEXT	
@load_red_texture  . . . . . . .	P Near	 000000D8 _TEXT	Length= 0000001F Public C
  @fail_load . . . . . . . . . .	L Near	 000000F1 _TEXT	
bluenote_sound . . . . . . . . .	P Near	 000002F4 _TEXT	Length= 0000001C Public C
create_track . . . . . . . . . .	P Near	 00000060 _TEXT	Length= 00000078 Public C
dequeue  . . . . . . . . . . . .	P Near	 0000018F _TEXT	Length= 0000004D Public C
  end_dequeue  . . . . . . . . .	L Near	 000001DB _TEXT	
enqueue  . . . . . . . . . . . .	P Near	 00000140 _TEXT	Length= 0000004F Public C
  end_enqueue  . . . . . . . . .	L Near	 0000018E _TEXT	
game_play_music  . . . . . . . .	P Near	 00000000 _TEXT	Length= 0000001C Public C
isQueueEmpty . . . . . . . . . .	P Near	 0000012B _TEXT	Length= 00000015 Public C
  queue_empty  . . . . . . . . .	L Near	 0000013A _TEXT	
isQueueFull  . . . . . . . . . .	P Near	 00000116 _TEXT	Length= 00000015 Public C
  queue_full . . . . . . . . . .	L Near	 00000125 _TEXT	
main_game_page . . . . . . . . .	P Near	 00000334 _TEXT	Length= 000001F4 Public C
  window . . . . . . . . . . . .	DWord	 bp + 00000008
  @main_loop . . . . . . . . . .	L Near	 0000036B _TEXT	
  @event_loop  . . . . . . . . .	L Near	 000003AD _TEXT	
  @check_key_press . . . . . . .	L Near	 000003E1 _TEXT	
  @key_A_pressed . . . . . . . .	L Near	 000003F5 _TEXT	
  @key_S_pressed . . . . . . . .	L Near	 0000041E _TEXT	
  @key_D_pressed . . . . . . . .	L Near	 00000442 _TEXT	
  @skip_generate_note  . . . . .	L Near	 0000046E _TEXT	
  @end_draw_notes  . . . . . . .	L Near	 00000495 _TEXT	
  @to_end_page . . . . . . . . .	L Near	 000004A6 _TEXT	
  @exit_program  . . . . . . . .	L Near	 000004D0 _TEXT	
  @end . . . . . . . . . . . . .	L Near	 00000524 _TEXT	
readFile . . . . . . . . . . . .	P Near	 00000310 _TEXT	Length= 00000024 Public C
rednote_sound  . . . . . . . . .	P Near	 000002D8 _TEXT	Length= 0000001C Public C
spawnDrum  . . . . . . . . . . .	P Near	 000001DC _TEXT	Length= 00000047 Public C
  spawnRed . . . . . . . . . . .	L Near	 00000203 _TEXT	
  end_spawn  . . . . . . . . . .	L Near	 00000222 _TEXT	
updateDrums  . . . . . . . . . .	P Near	 00000223 _TEXT	Length= 000000B5 Public C
  update_queue . . . . . . . . .	L Near	 0000027B _TEXT	
  end_update . . . . . . . . . .	L Near	 000002D7 _TEXT	


Symbols:

                N a m e                 Type     Value    Attr

@CodeSize  . . . . . . . . . . .	Number	 00000000h   
@DataSize  . . . . . . . . . . .	Number	 00000000h   
@Interface . . . . . . . . . . .	Number	 00000001h   
@Model . . . . . . . . . . . . .	Number	 00000007h   
@code  . . . . . . . . . . . . .	Text   	 _TEXT
@data  . . . . . . . . . . . . .	Text   	 FLAT
@fardata?  . . . . . . . . . . .	Text   	 FLAT
@fardata . . . . . . . . . . . .	Text   	 FLAT
@stack . . . . . . . . . . . . .	Text   	 FLAT
BUTTON_STATE_NORMAL  . . . . . .	Number	 00000000h   
BUTTON_STATE_PRESSED . . . . . .	Number	 00000001h   
CloseHandle@4  . . . . . . . . .	L Near	 00000000 FLAT	External C
CreateFileA@28 . . . . . . . . .	L Near	 00000000 FLAT	External C
DRUM_SPEED . . . . . . . . . . .	DWord	 000000E5 _DATA	
Drum_struct_size . . . . . . . .	Number	 00000008h   
ExitProcess@4  . . . . . . . . .	L Near	 00000000 FLAT	External C
FILE_ATTRIBUTE_NORMAL  . . . . .	Text   	 0x00000080
FILE_SHARE_READ  . . . . . . . .	Text   	 0x00000001
GENERIC_READ . . . . . . . . . .	Text   	 0x80000000
GetLastError@0 . . . . . . . . .	L Near	 00000000 FLAT	External C
GetStdHandle@4 . . . . . . . . .	L Near	 00000000 FLAT	External C
KeyA_state . . . . . . . . . . .	DWord	 00000E25 _DATA	
KeyD_state . . . . . . . . . . .	DWord	 00000E29 _DATA	
KeyS_state . . . . . . . . . . .	DWord	 00000E2D _DATA	
MAX_DRUMS  . . . . . . . . . . .	Number	 00000064h   
MAX_LINE_LENGTH  . . . . . . . .	Number	 000003E8h   
MAX_NOTES  . . . . . . . . . . .	Number	 00002710h   
OPEN_EXISTING  . . . . . . . . .	Number	 00000003h   
ReadFile@20  . . . . . . . . . .	L Near	 00000000 FLAT	External C
SCREEN_HEIGHT  . . . . . . . . .	Number	 000002D0h   
SCREEN_WIDTH . . . . . . . . . .	Text   	 1280.0
STD_OUTPUT_HANDLE  . . . . . . .	Number	 -0000000Bh   
WriteConsoleA@20 . . . . . . . .	L Near	 00000000 FLAT	External C
WriteFile@20 . . . . . . . . . .	L Near	 00000000 FLAT	External C
beige_color  . . . . . . . . . .	sfColor	 00000E45 _DATA	
bgSprite . . . . . . . . . . . .	DWord	 00000109 _DATA	
bgTexture  . . . . . . . . . . .	DWord	 00000105 _DATA	
bg_path  . . . . . . . . . . . .	Byte	 00000000 _DATA	
bgmusic  . . . . . . . . . . . .	DWord	 00000D95 _DATA	
blackColor . . . . . . . . . . .	sfColor	 00000E35 _DATA	
black_color  . . . . . . . . . .	sfColor	 00000E49 _DATA	
blueDrumTexture  . . . . . . . .	DWord	 00000111 _DATA	
blue_drum_path . . . . . . . . .	Byte	 00000039 _DATA	
blue_note_sound_path . . . . . .	Byte	 000000CC _DATA	
bpmTag . . . . . . . . . . . . .	Byte	 00001B63 _DATA	
bpm  . . . . . . . . . . . . . .	DWord	 00000DCD _DATA	
bytesRead  . . . . . . . . . . .	DWord	 0000136A _DATA	
clock  . . . . . . . . . . . . .	DWord	 00000DC5 _DATA	
comma  . . . . . . . . . . . . .	Byte	 00001B7C _DATA	
create_button  . . . . . . . . .	L Near	 00000000 FLAT	External C
currentPage  . . . . . . . . . .	DWord	 00000000 FLAT	External C
currentTime  . . . . . . . . . .	DWord	 00001B5F _DATA	
current_drum . . . . . . . . . .	Drum	 00000DB1 _DATA	
dark_gray_color  . . . . . . . .	sfColor	 00000E3D _DATA	
drumQueue  . . . . . . . . . . .	DWord	 00000115 _DATA	
drumSpeed  . . . . . . . . . . .	DWord	 00001B7E _DATA	
drumStep . . . . . . . . . . . .	DWord	 00001B82 _DATA	
endTag . . . . . . . . . . . . .	Byte	 00001B77 _DATA	
event  . . . . . . . . . . . . .	sfEvent	 00000DF5 _DATA	
filename . . . . . . . . . . . .	Byte	 00001359 _DATA	
front  . . . . . . . . . . . . .	DWord	 00000DB9 _DATA	
good_count . . . . . . . . . . .	DWord	 00001BCA _DATA	
gray_color . . . . . . . . . . .	sfColor	 00000E39 _DATA	
great_count  . . . . . . . . . .	DWord	 00001BC6 _DATA	
hFile  . . . . . . . . . . . . .	DWord	 00001366 _DATA	
hitWindowGood  . . . . . . . . .	DWord	 00001BBE _DATA	
hitWindowGreat . . . . . . . . .	DWord	 00001BBA _DATA	
hitWindowMiss  . . . . . . . . .	DWord	 00001BC2 _DATA	
initialPosition  . . . . . . . .	sfVector2f  00000E4D _DATA	
light_gray_color . . . . . . . .	sfColor	 00000E41 _DATA	
lineBuffer . . . . . . . . . . .	Byte	 00001776 _DATA	
miss_count . . . . . . . . . . .	DWord	 00001BCE _DATA	
movePosition . . . . . . . . . .	sfVector2f  00001BB2 _DATA	
msgReadFail  . . . . . . . . . .	Byte	 00001B86 _DATA	
msgReadSuccess . . . . . . . . .	Byte	 00001B9A _DATA	
musicInfo_bpm  . . . . . . . . .	DWord	 0000176E _DATA	
musicInfo_offset . . . . . . . .	DWord	 00001772 _DATA	
notePosition . . . . . . . . . .	sfVector2f  00001BAA _DATA	
noteSection  . . . . . . . . . .	Byte	 00001B5E _DATA	
noteSpawnInterval  . . . . . . .	DWord	 00000DD1 _DATA	
noteTimings  . . . . . . . . . .	DWord	 00000F55 _DATA	
note_timer . . . . . . . . . . .	DWord	 00000DC9 _DATA	
notes  . . . . . . . . . . . . .	Byte	 00000E55 _DATA	
offsetTag  . . . . . . . . . . .	Byte	 00001B68 _DATA	
outline_thickness  . . . . . . .	DWord	 00000101 _DATA	
qsize  . . . . . . . . . . . . .	DWord	 00000DC1 _DATA	
readBuffer . . . . . . . . . . .	Byte	 0000136E _DATA	
rear . . . . . . . . . . . . . .	DWord	 00000DBD _DATA	
redDrumTexture . . . . . . . . .	DWord	 0000010D _DATA	
red_drum_path  . . . . . . . . .	Byte	 00000020 _DATA	
red_note_sound_path  . . . . . .	Byte	 000000B4 _DATA	
score  . . . . . . . . . . . . .	DWord	 00001BD2 _DATA	
selectedBeatmapPath  . . . . . .	Byte	 0000009E _DATA	
selectedMusicPath  . . . . . . .	Byte	 00000088 _DATA	
selected_beatmap_path  . . . . .	Byte	 00000069 _DATA	
selected_music_path  . . . . . .	Byte	 00000053 _DATA	
sfClock_create . . . . . . . . .	L Near	 00000000 FLAT	External C
sfClock_destroy  . . . . . . . .	L Near	 00000000 FLAT	External C
sfClock_getElapsedTime . . . . .	L Near	 00000000 FLAT	External C
sfClock_restart  . . . . . . . .	L Near	 00000000 FLAT	External C
sfClose  . . . . . . . . . . . .	Number	 00000004h   
sfColor_fromRGBA . . . . . . . .	L Near	 00000000 FLAT	External C
sfColor_fromRGB  . . . . . . . .	L Near	 00000000 FLAT	External C
sfEvtClosed  . . . . . . . . . .	Number	 00000000h   
sfEvtGainedFocus . . . . . . . .	Number	 00000003h   
sfEvtKeyPressed  . . . . . . . .	Number	 00000005h   
sfEvtKeyReleased . . . . . . . .	Number	 00000006h   
sfEvtLostFocus . . . . . . . . .	Number	 00000002h   
sfEvtMouseButtonPressed  . . . .	Number	 00000009h   
sfEvtMouseButtonReleased . . . .	Number	 0000000Ah   
sfEvtMouseEntered  . . . . . . .	Number	 0000000Ch   
sfEvtMouseLeft . . . . . . . . .	Number	 0000000Dh   
sfEvtMouseMoved  . . . . . . . .	Number	 0000000Bh   
sfEvtMouseWheelMoved . . . . . .	Number	 00000007h   
sfEvtMouseWheelScrolled  . . . .	Number	 00000008h   
sfEvtResized . . . . . . . . . .	Number	 00000001h   
sfEvtTextEntered . . . . . . . .	Number	 00000004h   
sfFalse  . . . . . . . . . . . .	Number	 00000000h   
sfFont_createFromFile  . . . . .	L Near	 00000000 FLAT	External C
sfFont_destroy . . . . . . . . .	L Near	 00000000 FLAT	External C
sfFullscreen . . . . . . . . . .	Number	 00000008h   
sfKeyA . . . . . . . . . . . . .	Number	 00000000h   
sfKeyD . . . . . . . . . . . . .	Number	 00000003h   
sfKeyEnter . . . . . . . . . . .	Number	 0000003Ah   
sfKeyEscape  . . . . . . . . . .	Number	 00000024h   
sfKeyS . . . . . . . . . . . . .	Number	 00000012h   
sfMouseLeft  . . . . . . . . . .	Number	 00000000h   
sfMouseMiddle  . . . . . . . . .	Number	 00000002h   
sfMouseRight . . . . . . . . . .	Number	 00000001h   
sfMusic_createFromFile . . . . .	L Near	 00000000 FLAT	External C
sfMusic_destroy  . . . . . . . .	L Near	 00000000 FLAT	External C
sfMusic_getStatus  . . . . . . .	L Near	 00000000 FLAT	External C
sfMusic_play . . . . . . . . . .	L Near	 00000000 FLAT	External C
sfMusic_setLoop  . . . . . . . .	L Near	 00000000 FLAT	External C
sfMusic_stop . . . . . . . . . .	L Near	 00000000 FLAT	External C
sfNone . . . . . . . . . . . . .	Number	 00000000h   
sfRectangleShape_create  . . . .	L Near	 00000000 FLAT	External C
sfRectangleShape_destroy . . . .	L Near	 00000000 FLAT	External C
sfRectangleShape_setFillColor  .	L Near	 00000000 FLAT	External C
sfRectangleShape_setOutlineColor .	L Near	 00000000 FLAT	External C
sfRectangleShape_setOutlineThickness .	L Near	 00000000 FLAT	External C
sfRectangleShape_setPosition . .	L Near	 00000000 FLAT	External C
sfRectangleShape_setSize . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_clear . . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_close . . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_create  . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_destroy . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_display . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_drawRectangleShape 	L Near	 00000000 FLAT	External C
sfRenderWindow_drawSprite  . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_drawText  . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_isOpen  . . . . .	L Near	 00000000 FLAT	External C
sfRenderWindow_pollEvent . . . .	L Near	 00000000 FLAT	External C
sfResize . . . . . . . . . . . .	Number	 00000002h   
sfSleep  . . . . . . . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_create  . . . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_destroy . . . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_getPosition . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_move  . . . . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_setOrigin . . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_setPosition . . . . . .	L Near	 00000000 FLAT	External C
sfSprite_setTexture  . . . . . .	L Near	 00000000 FLAT	External C
sfText_create  . . . . . . . . .	L Near	 00000000 FLAT	External C
sfText_destroy . . . . . . . . .	L Near	 00000000 FLAT	External C
sfText_getGlobalBounds . . . . .	L Near	 00000000 FLAT	External C
sfText_getLocalBounds  . . . . .	L Near	 00000000 FLAT	External C
sfText_setCharacterSize  . . . .	L Near	 00000000 FLAT	External C
sfText_setFillColor  . . . . . .	L Near	 00000000 FLAT	External C
sfText_setFont . . . . . . . . .	L Near	 00000000 FLAT	External C
sfText_setOutlineColor . . . . .	L Near	 00000000 FLAT	External C
sfText_setOutlineThickness . . .	L Near	 00000000 FLAT	External C
sfText_setPosition . . . . . . .	L Near	 00000000 FLAT	External C
sfText_setString . . . . . . . .	L Near	 00000000 FLAT	External C
sfTexture_createFromFile . . . .	L Near	 00000000 FLAT	External C
sfTexture_destroy  . . . . . . .	L Near	 00000000 FLAT	External C
sfTitlebar . . . . . . . . . . .	Number	 00000001h   
sfTrue . . . . . . . . . . . . .	Number	 00000001h   
spritePosX . . . . . . . . . . .	DWord	 000000F9 _DATA	
spritePosY . . . . . . . . . . .	DWord	 000000FD _DATA	
startTag . . . . . . . . . . . .	Byte	 00001B70 _DATA	
stdout_handle  . . . . . . . . .	DWord	 00001355 _DATA	
totalNotes . . . . . . . . . . .	DWord	 00000DD5 _DATA	
trackBounds  . . . . . . . . . .	sfFloatRect  00000D99 _DATA	
track_height . . . . . . . . . .	DWord	 000000E9 _DATA	
track_shape  . . . . . . . . . .	Button	 00000DA9 _DATA	
track_width  . . . . . . . . . .	DWord	 000000ED _DATA	
track_x  . . . . . . . . . . . .	DWord	 000000F1 _DATA	
track_y  . . . . . . . . . . . .	DWord	 000000F5 _DATA	
whiteColor . . . . . . . . . . .	sfColor	 00000E31 _DATA	
windowTitle  . . . . . . . . . .	Byte	 00000DE5 _DATA	
window_videoMode . . . . . . . .	sfVideoMode  00000DD9 _DATA	

	   0 Warnings
	   0 Errors
